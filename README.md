# TecnoShop API

Este proyecto es una API RESTful desarrollada con Spring Boot para la gestión de clientes, productos y facturas de una tienda ficticia llamada "TecnoShop".

La API permite realizar operaciones CRUD (Crear, Leer, Actualizar, Eliminar) sobre los recursos `cliente` y `producto`, y permite la creación y consulta de `facturas`.

## 1. Requisitos Previos

Para poder ejecutar este proyecto, necesitarás tener instalado lo siguiente:

-   **Java Development Kit (JDK):** Versión 17 o superior.
-   **Apache Maven:** Versión 3.8 o superior.
-   **MySQL:** Una instancia de MySQL Server en ejecución.

## 2. Configuración de la Base de Datos

Antes de ejecutar la aplicación, asegúrate de que tu instancia de MySQL esté configurada correctamente.

1.  **Crear la Base de Datos:** La aplicación intentará crear la base de datos `tecnoshop` si no existe. Sin embargo, puedes crearla manualmente:
    ```sql
    CREATE DATABASE tecnoshop;
    ```

2.  **Usuario y Contraseña:** El proyecto está configurado para usar las siguientes credenciales:
    -   **Usuario:** `root`
    -   **Contraseña:** `Clases.2025.2025`

    Si tus credenciales son diferentes, debes actualizarlas en el archivo `src/main/resources/application.properties`.

## 3. Cómo Ejecutar la Aplicación

Puedes ejecutar la aplicación directamente usando el plugin de Maven para Spring Boot.

1.  Abre una terminal o línea de comandos.
2.  Navega hasta el directorio raíz del proyecto (donde se encuentra el archivo `pom.xml`).
3.  Ejecuta el siguiente comando:

    ```bash
    mvn spring-boot:run
    ```

Una vez ejecutado, el servidor se iniciará en el puerto `8080` y la API estará lista para recibir peticiones.

## 4. Endpoints de la API

### Clientes (`/api/clientes`)

| Método HTTP | Endpoint                 | Descripción                                     | Body de Ejemplo (para POST/PUT)                                                              |
| :---------- | :----------------------- | :---------------------------------------------- | :------------------------------------------------------------------------------------------- |
| `GET`       | `/api/clientes`          | Obtiene una lista de todos los clientes.        | N/A                                                                                          |
| `GET`       | `/api/clientes/{id}`     | Obtiene un cliente específico por su ID.        | N/A                                                                                          |
| `POST`      | `/api/clientes`          | Crea un nuevo cliente.                          | `{"nombre": "Juan", "apellido": "Perez", "email": "juan.perez@example.com", "telefono": "123456789"}` |
| `PUT`       | `/api/clientes/{id}`     | Actualiza un cliente existente por su ID.       | `{"nombre": "Juan Carlos", "apellido": "Perez", "email": "juan.perez.new@example.com"}`      |
| `DELETE`    | `/api/clientes/{id}`     | Elimina un cliente por su ID.                   | N/A                                                                                          |

### Productos (`/api/productos`)

| Método HTTP | Endpoint                  | Descripción                                      | Body de Ejemplo (para POST/PUT)                                                                 |
| :---------- | :------------------------ | :----------------------------------------------- | :---------------------------------------------------------------------------------------------- |
| `GET`       | `/api/productos`          | Obtiene una lista de todos los productos.        | N/A                                                                                             |
| `GET`       | `/api/productos/{id}`     | Obtiene un producto específico por su ID.        | N/A                                                                                             |
| `POST`      | `/api/productos`          | Crea un nuevo producto.                          | `{"nombre": "Laptop Pro", "descripcion": "Laptop de alto rendimiento", "precio": 1200.50, "stock": 50}` |
| `PUT`       | `/api/productos/{id}`     | Actualiza un producto existente por su ID.       | `{"nombre": "Laptop Pro X", "precio": 1250.00, "stock": 45}`                                     |
| `DELETE`    | `/api/productos/{id}`     | Elimina un producto por su ID.                   | N/A                                                                                             |

### Facturas (`/api/facturas`)

| Método HTTP | Endpoint              | Descripción                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      -
| :---------- | :-------------------- | :----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `GET`       | `/api/facturas`       | Obtiene una lista de todas las facturas.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        -
| `GET`       | `/api/facturas/{id}`  | Obtiene una factura específica por su ID.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     -
| `POST`      | `/api/facturas`       | Crea una nueva factura. Al crearla, se descuenta el stock de los productos y se calcula el subtotal, IVA (21%) y total. | `{"clienteId": 1, "detalles": [{"productoId": 1, "cantidad": 2}]}` |

### Endpoints de Proveedores (`/api/proveedores`)

| Método HTTP | Endpoint                | Descripción                               | Body de Ejemplo                               |
| :---------- | :---------------------- | :---------------------------------------- | :-------------------------------------------- |
| `GET`       | `/api/proveedores`      | Obtiene una lista de todos los proveedores. | N/A                                           |
| `GET`       | `/api/proveedores/{id}` | Obtiene un proveedor por su ID.           | N/A                                           |
| `POST`      | `/api/proveedores`      | Crea un nuevo proveedor. (Admin)          | `{"nombre": "Proveedor Tech", "numeroContacto": "123456789"}` |
| `PUT`       | `/api/proveedores/{id}` | Actualiza un proveedor existente. (Admin) | `{"nombre": "Nuevo Nombre Tech", "numeroContacto": "987654321"}` |
| `DELETE`    | `/api/proveedores/{id}` | Elimina un proveedor por su ID. (Admin)   | N/A                                           |

### Endpoints de Pedidos (`/api/pedidos`)

| Método HTTP | Endpoint            | Descripción                               | Body de Ejemplo                               |
| :---------- | :------------------ | :---------------------------------------- | :-------------------------------------------- |
| `GET`       | `/api/pedidos`      | Obtiene una lista de todos los pedidos.   | N/A                                           |
| `GET`       | `/api/pedidos/{id}` | Obtiene un pedido por su ID.              | N/A                                           |
| `POST`      | `/api/pedidos`      | Crea un nuevo pedido.                     | `{"clienteId": 1, "estado": "PENDIENTE", "direccionEnvio": "Calle Falsa 123", "detalles": [{"productoId": 1, "cantidad": 1}]}` |
| `PUT`       | `/api/pedidos/{id}` | Actualiza un pedido existente. (Admin)    | `{"clienteId": 1, "estado": "PROCESADO", ...}` |
| `DELETE`    | `/api/pedidos/{id}` | Elimina un pedido por su ID. (Admin)      | N/A                                           |

## 5. Seguridad y Autenticación

La API está protegida con Spring Security y JWT. Para acceder a los endpoints protegidos, primero debes registrar un usuario, iniciar sesión para obtener un token y luego incluir ese token en el encabezado de tus solicitudes.

### Endpoints de Autenticación (`/api/auth`)

| Método HTTP | Endpoint              | Descripción                                      | Body de Ejemplo                               |
| :---------- | :-------------------- | :----------------------------------------------- | :-------------------------------------------- |
| `POST`      | `/api/auth/register`  | Registra un nuevo usuario con el rol `ROLE_USER`.| `{"username": "user", "password": "password123"}` |
| `POST`      | `/api/auth/login`     | Autentica a un usuario y devuelve un token JWT.  | `{"username": "user", "password": "password123"}` |

### Cómo usar el Token JWT

Una vez que obtienes el token del endpoint `/login`, debes enviarlo en el encabezado `Authorization` de cada solicitud a los endpoints protegidos, con el prefijo `Bearer `.

**Ejemplo de encabezado:**
`Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1c2VyIiwiaWF0IjoxNj...`

### Protección por Roles

-   Las operaciones de `DELETE` en `/api/clientes/{id}` y `/api/productos/{id}` están restringidas solo para usuarios con el rol `ROLE_ADMIN`.
-   Por defecto, se crea un usuario `admin` con contraseña `admin123` que tiene este rol.

---
*Proyecto generado como ejemplo de una API REST con Spring Boot.*
